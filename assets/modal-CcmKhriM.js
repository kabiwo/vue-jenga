import{d as B,h as i,u as H,c as D,b as P,o as f,k as v,af as $,j as k,i as F,ac as y,e as u,ag as x,ae as T,a9 as E,t as j,r as N,q as V,ab as O,ah as h}from"./index-BiiRSzpX.js";import{E as R,t as q}from"./VjForm.vue_vue_type_script_setup_true_lang-GMwbxZZP-GmFpasEo.js";import{t as g,f as S,O as b}from"./object-mrbcERGG-Br3DnkxI.js";import"./el-popper-DrZ-dYdU.js";const M={key:0,class:"modal-footer"},U=B({__name:"VjModal",props:{title:{},width:{},cancelText:{},confirmText:{},confirmFunc:{type:Function},confirmCheckFunc:{type:Function},showFunc:{type:Function},noFooter:{type:Boolean},elDialogProps:{},elDialogEmit:{},slots:{},skDefault:{},skHeader:{}},emits:["cancel","confirm","closed"],setup(w,{expose:C,emit:_}){const o=i(!1),e=w,c=_,m=H(),r=D(()=>S(b(m,a=>a),e.slots||{})),s=i(),p=i(!1),l=()=>{o.value=!1,c("cancel")},t=async()=>{if(e.confirmCheckFunc){let[a,n]=await h(()=>e.confirmCheckFunc())();if(!n){console.log(a);return}}if(e.confirmFunc){p.value=!0;let[a,n]=await h(()=>e.confirmFunc())();p.value=!1,n?o.value=!1:console.log(a)}else c("confirm")};return C({dialog:s,show:a=>{o.value=!0,setTimeout(()=>{e.showFunc&&e.showFunc(a)})},dialogShow:o}),(a,n)=>(f(),P("div",null,[v(u(R),V({ref_key:"dialogRef",ref:s,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=d=>o.value=d),"close-on-click-modal":!1,"destroy-on-close":"",title:e.title,width:e.width,onClosed:n[1]||(n[1]=d=>a.$emit("closed")),style:{"--el-message-close-size":"0.4rem"}},e.elDialogProps,O(e.elDialogEmit||{})),$({default:k(d=>[e.skDefault&&r.value[e.skDefault]?(f(),F(y(u(g)(r.value[e.skDefault],d)),{key:0})):N(a.$slots,"default",{key:1})]),footer:k(()=>[e.noFooter?x("",!0):(f(),P("div",M,[v(u(T),{onClick:l},{default:k(()=>[E(j(e.cancelText||"取消"),1)]),_:1}),v(u(T),{type:"primary",loading:p.value,onClick:t},{default:k(()=>[E(j(e.confirmText||"确定"),1)]),_:1},8,["loading"])]))]),_:2},[e.skHeader&&r.value[e.skHeader]?{name:"default",fn:k(d=>[(f(),F(y(u(g)(r.value[e.skHeader],d))))]),key:"0"}:void 0]),1040,["modelValue","title","width"])]))}}),G=B({__name:"VjModalForm",props:{title:{},width:{},cancelText:{},confirmText:{},confirmFunc:{type:Function},confirmCheckFunc:{type:Function},showFunc:{type:Function},noFooter:{type:Boolean},elDialogProps:{},elDialogEmit:{},slots:{},skDefault:{},skHeader:{},formProps:{},skPre:{},skPost:{}},emits:["cancel","confirm","closed"],setup(w,{expose:C,emit:_}){const o=w,e=H(),c=D(()=>S(b(e,l=>l),o.slots||{})),m=i(),r=i();i(!1);const s=i({}),p=D(()=>{let l={};return l.confirmCheckFunc=async()=>{let t=await m.value.validate();if(!t[0])return console.log(t),!1;if(o.confirmCheckFunc){let[a,n]=await h(()=>o.confirmCheckFunc(s.value))();if(!n)return console.log(a),!1}return!0},l.confirmFunc=async()=>{if(o.confirmFunc){let[t,a]=await h(()=>o.confirmFunc(s.value))();if(!a)return console.log(t),!1}return!0},Object.entries(o).forEach(([t,a],n)=>{["formProps","confirmFunc","confirmCheckFunc"].includes(t)||(l[t]=a)}),l});return C({form:m,modal:r,show:l=>{l?s.value=l:s.value={},setTimeout(()=>{r.value?.show(l)})},setData:(l,t)=>{t?s.value=Object.assign({},s.value,l):s.value=l},getData:()=>s.value,validate:async()=>m.value.validate()}),(l,t)=>(f(),P("div",null,[v(U,V({ref_key:"modalRef",ref:r},p.value),{default:k(()=>[o.skPre&&c.value[o.skPre]?(f(),F(y(u(g)(c.value[o.skPre])),{key:0})):x("",!0),v(q,V({ref_key:"formRef",ref:m,modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value=a)},o.formProps||{},{slots:c.value}),null,16,["modelValue","slots"]),o.skPost&&c.value[o.skPost]?(f(),F(y(u(g)(c.value[o.skPost])),{key:1})):x("",!0)]),_:1},16)]))}});export{G as Y,U as q};
